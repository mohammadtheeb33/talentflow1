(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[716],{1177:function(e,t,n){Promise.resolve().then(n.bind(n,6826))},6826:function(e,t,n){"use strict";n.d(t,{LoginClient:function(){return l}});var a=n(7437),r=n(9376),o=n(2265),s=n(6410),i=n(3301);function c(){let[e,t]=(0,o.useState)(""),[n,r]=(0,o.useState)(""),[c,u]=(0,o.useState)(!1),[l,d]=(0,o.useState)(null),h=async t=>{t.preventDefault(),d(null),u(!0);try{let t=(0,s.kL)();await (0,i.e5)(t,e,n),d("تم تسجيل الدخول بنجاح")}catch(e){var a;d(function(e){switch(e){case"auth/invalid-email":return"البريد الإلكتروني غير صالح";case"auth/user-not-found":case"auth/invalid-credential":return"لا يوجد مستخدم بهذه البيانات";case"auth/wrong-password":return"كلمة المرور غير صحيحة";case"auth/too-many-requests":return"محاولات كثيرة، الرجاء المحاولة لاحقًا";case"auth/network-request-failed":return"تعذّر الاتصال بالشبكة";default:return"تعذّر تسجيل الدخول"}}(null!==(a=null==e?void 0:e.code)&&void 0!==a?a:""))}finally{u(!1)}};return(0,a.jsxs)("form",{onSubmit:h,className:"space-y-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-xs text-gray-600",children:"البريد الإلكتروني"}),(0,a.jsx)("input",{type:"email",value:e,onChange:e=>t(e.target.value),required:!0,className:"mt-1 w-full rounded border p-2 text-sm",placeholder:"name@example.com"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-xs text-gray-600",children:"كلمة المرور"}),(0,a.jsx)("input",{type:"password",value:n,onChange:e=>r(e.target.value),required:!0,className:"mt-1 w-full rounded border p-2 text-sm",placeholder:"••••••••"})]}),(0,a.jsx)("button",{type:"submit",disabled:c,className:"w-full rounded-md bg-indigo-600 px-3 py-2 text-sm text-white hover:bg-indigo-700 disabled:opacity-60",children:c?"جاري تسجيل الدخول…":"تسجيل الدخول"}),l&&(0,a.jsx)("div",{className:"rounded-md border bg-gray-50 p-3 text-xs text-gray-700",children:l})]})}var u=n(6629);function l(){let e=(0,r.useSearchParams)(),t=(0,r.useRouter)(),n=e.get("tenant")||"consumers",l="1"===e.get("outlook"),[d,h]=(0,o.useState)(!1);return(0,o.useEffect)(()=>{l&&h(!0)},[l]),(0,o.useEffect)(()=>{try{let n=(0,s.kL)(),a=(0,i.Aj)(n,n=>{if(n&&!n.isAnonymous){let n=e.get("next")||"/Dashboard";t.replace(n)}});return()=>{try{a()}catch(e){}}}catch(e){}},[e,t]),(0,a.jsxs)("main",{className:"mx-auto max-w-md rounded-lg border bg-white p-6",children:[(0,a.jsx)("h1",{className:"text-lg font-semibold",children:"Sign in"}),(0,a.jsx)("p",{className:"mt-1 text-xs text-gray-600",children:"Use your email and password or continue with Outlook."}),(0,a.jsx)("div",{className:"mt-4",children:(0,a.jsx)(c,{})}),(0,a.jsxs)("div",{className:"mt-6",children:[(0,a.jsx)("div",{className:"mb-2 text-xs text-gray-500",children:"Outlook"}),(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsxs)("a",{href:"/auth/login?provider=outlook&tenant=".concat(n),className:"inline-flex items-center gap-2 rounded-md border bg-white px-3 py-2 text-xs hover:bg-gray-50",children:["Continue with Outlook (",n,")"]}),(0,a.jsx)("a",{href:"/auth/login?provider=outlook&tenant=".concat("consumers"===n?"organizations":"consumers"),className:"text-xs text-indigo-600 hover:underline",children:"Switch tenant"}),(0,a.jsx)("button",{onClick:()=>h(!0),className:"rounded-md border bg-white px-3 py-2 text-xs hover:bg-gray-50",children:"Connect Outlook…"})]})]}),d&&(0,a.jsx)(u.W,{isOpen:d,onClose:()=>h(!1)})]})}},9376:function(e,t,n){"use strict";var a=n(5475);n.o(a,"useParams")&&n.d(t,{useParams:function(){return a.useParams}}),n.o(a,"usePathname")&&n.d(t,{usePathname:function(){return a.usePathname}}),n.o(a,"useRouter")&&n.d(t,{useRouter:function(){return a.useRouter}}),n.o(a,"useSearchParams")&&n.d(t,{useSearchParams:function(){return a.useSearchParams}})},6410:function(e,t,n){"use strict";n.d(t,{X9:function(){return d},bH:function(){return h},kL:function(){return l},m6:function(){return p},mi:function(){return m}});var a=n(738),r=n(3301),o=n(5978),s=n(62),i=n(257);let c={apiKey:"AIzaSyATtmjTHjfMEesV1HQU_x1M3W_g_IWYC-g",authDomain:"cvchk-1a7e0.firebaseapp.com",projectId:"cvchk-1a7e0",storageBucket:"cvchk-1a7e0.firebasestorage.app",messagingSenderId:"318794750",appId:"1:318794750:web:ead1f9207f928eb2696eaf",measurementId:"G-VEX3P44B83"},u=null;function l(){return u||(u=(0,a.getApps)().length?(0,a.getApps)()[0]:(0,a.initializeApp)(c)),(0,r.v0)(u)}function d(){u||(u=(0,a.getApps)().length?(0,a.getApps)()[0]:(0,a.initializeApp)(c));let e=(0,o.getFirestore)(u);try{let t="localhost"===window.location.hostname||"127.0.0.1"===window.location.hostname,n="1"===String("0"),a=Number(i.env.FIREBASE_EMULATORS_FIRESTORE_PORT||0)||8090;t&&n&&(0,o.connectFirestoreEmulator)(e,"127.0.0.1",a)}catch(e){}return e}function h(){u||(u=(0,a.getApps)().length?(0,a.getApps)()[0]:(0,a.initializeApp)(c));let e=(0,s.getStorage)(u);try{let t="localhost"===window.location.hostname||"127.0.0.1"===window.location.hostname,n="1"===String("0"),a=Number(i.env.FIREBASE_EMULATORS_STORAGE_PORT||0)||9199;t&&n&&(0,s.connectStorageEmulator)(e,"127.0.0.1",a)}catch(e){}return e}async function m(e){let t=h();try{let n=(0,s.ref)(t,e);return await (0,s.getDownloadURL)(n)}catch(t){try{let t=String("cvchk-1a7e0.firebasestorage.app"),n="1"===String("0")?"http://127.0.0.1:"+(i.env.FIREBASE_EMULATORS_STORAGE_PORT||9199):"https://firebasestorage.googleapis.com",a=t.endsWith(".appspot.com")||t.endsWith(".firebasestorage.app")?t:"".concat(t),r=encodeURIComponent(e);return"".concat(n,"/v0/b/").concat(a,"/o/").concat(r,"?alt=media")}catch(e){throw t}}}async function p(){try{var e,t;let n=l(),a=n.currentUser;if(null==a?void 0:a.uid)return a.uid;if(await new Promise(e=>(0,r.Aj)(n,e)),null===(e=n.currentUser)||void 0===e?void 0:e.uid)return n.currentUser.uid;if(await (0,r.XB)(n),await new Promise(e=>(0,r.Aj)(n,e)),!(null===(t=n.currentUser)||void 0===t?void 0:t.uid))throw Error("Unable to establish user session");return n.currentUser.uid}catch(a){let e=String((null==a?void 0:a.code)||"").toLowerCase(),t=String((null==a?void 0:a.message)||"").toLowerCase();"localhost"===window.location.hostname||window.location.hostname;let n="1"===(i.env.NEXT_PUBLIC_FORCE_DEV_UID||"");if(t.includes("invalid-api-key")||e.includes("admin-restricted-operation")||e.includes("operation-not-allowed")||e.includes("network-request-failed")||e.includes("config")||n)try{let e="dev:uid",t=window.localStorage.getItem(e);return t||(t="dev-".concat(Math.random().toString(36).slice(2)),window.localStorage.setItem(e,t)),t}catch(e){return"dev-".concat(Date.now())}throw a}}}},function(e){e.O(0,[358,139,2,629,971,117,744],function(){return e(e.s=1177)}),_N_E=e.O()}]);